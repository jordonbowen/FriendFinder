<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>FriendFinder</title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">


       
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

       
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>

    </head>
    <body>

        <div class="container">
            <h2>Your new life begins here!</h2>
            <hr>

            <h3><b>Tell us a little bit about yourself</b></h3>
            <h4 class="mainInput">Name (Required) <span class="error text-danger"></span> </h4>
            <input type="text" name="" id="name" class="form-control">

            <h4 class="mainInput">Link to Photo Image (Required) <span class="error text-danger"></span> </h4>
            <input type="text" name="" id="image" class="form-control">

            <hr>

            <h3 class="question"><b>Question 1</b></h3>
            <h4>Leaving the toilet seat up isn't a big deal.</h4>
            <select class="selectpicker" id="q1" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>

            <h3 class="question"><b>Question 2</b></h3>
            <h4>Pepsi is better than Coke.</h4>
            <select  class="selectpicker" id="q2" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>


            <h3 class="question"><b>Question 3</b></h3>
            <h4>KFC isn't real chicken.</h4>
            <select class="selectpicker" id="q3" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>


            <h3 class="question"><b>Question 4</b></h3>
            <h4>Cereal should always go before the milk when preparing a bowl.</h4>
            <select class="selectpicker" id="q4" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>


            <h3 class="question"><b>Question 5</b></h3>
            <h4>Apple devices are better than Android devices.</h4>
            <select class="selectpicker" id="q5" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>


            <h3 class="question"><b>Question 6</b></h3>
            <h4>I prefer natural hair over synthetic.</h4>
            <select class="selectpicker" id="q6" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>


            <h3 class="question"><b>Question 7</b></h3>
            <h4>I eat the crust on the pizza too.</h4>
            <select class="selectpicker" id="q7" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>

            <h3 class="question"><b>Question 8</b></h3>
            <h4>Star Wars is better than Star Trek.</h4>
            <select class="selectpicker" id="q8" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>

            <h3 class="question"><b>Question 9</b></h3>
            <h4>Hamburgers are better than hotdogs.</h4>
            <select class="selectpicker" id="q9" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>

            <h3 class="question"><b>Question 10</b></h3>
            <h4>I enjoy watching anime.</h4>
            <select class="selectpicker" id="q10" title="Choose one of the following...">
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (somewhat disagree)</option>
                <option value="3">3 (neutral)</option>
                <option value="4">4 (somewhat agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>

            <br>
            <br>

            <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle"></i>  Submit</button>

            <hr>
            <footer class="footer">
                <div class="container">
                    <p><a href="/api" target="_blank">API Friends List</a> | <a href="https://github.com/m081779/FriendFinder" target="_blank">GitHub Repo</a></p>
                </div>
            </footer>

        </div>

        
        <div id="myModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content text-center">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">The best match for you is:</h4>
                    </div>
                    <div class="modal-body">
                        <img id="modalImage" class="well" src="" alt="" height="300">
                        <h3 id="modalName" class="text-danger"></h3>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            $(document).ready(function () {
                
                $( '#submit' ).on( 'click', function ( event ) {
                    event.preventDefault();
                    let newFriend = {};
                    
                    let inputComplete = false;
                    
                    let name = $( '#name' ).val().trim();
                    let photo = $( '#image' ).val().trim();
                    
                    if ( name === '' || photo === '') {
                        inputComplete = false;
                        $( '.error' ).empty();
                        $( '.error' ).text( '  You must fill out this field!' )
                    } else {
                        inputComplete = true;
                    }
                    if ( inputComplete ) {
                        
                        $( '.error' ).empty();
                        let newFriend = {
                            name,
                            photo,
                            scores:[]
                        }
                        
                        for ( let i = 1; i <= 10; i++ ) {
                            let score = $( '#q'+ i ).val() || "3"
                            newFriend.scores.push( score );
                            $( '#q'+ i ).val('').selectpicker('refresh');
                        }
                        
                        $( '#name' ).val( '' );
                        $( '#image' ).val( '' );
                        
                        $.post("/api/friends", newFriend)
                            .done(function(data) {   
                            console.log('data:',data)
                        });
                        
                        $.get("/bestFriend", function (data2) {
                            $('#myModal').modal('toggle');
                            $('#modalName').text(data2.friend.name);
                            $('#modalImage').attr("src", data2.friend.photo);
                        });	
                    }
                });
            });
        </script>
    </body>
</html>